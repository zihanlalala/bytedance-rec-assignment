# 第4讲课后作业：DPP打散实验

## 实验内容
根据论文内容，实现了DPP的greedy解码和beam search解码算法。并观察了不同beam size和 系数theta 的情况下，模型的解码速度以及多样性的变化。
实验设置：随机生成了100个候选，每个候选item的embedding维度为64，并且随机生成了每个用户对视频的喜好程度,最后生成了8个推荐样本。模型的指重复一万次实验总计的需要的秒数，ILAD用于衡量多样性，log_prob ratio表示模型与greedy模型的log det(L) 的比值

## 实验结果

| setting（theta=0） | speed | ILAD | log_prob ratio |
| ------- | ----- | ---- | -------------- |
| greedy  | 3.95  | 7.65 |     1          |
|  beam=1   |  10.25   | 7.46 | 0.98 |
|  beam=2   |  11.03   | 5.79 | 1.07 |
|  beam=3   |  11.95   | 5.71 | 1.09 |
|  beam=4   |  12.31   | 6.11 | 1.13 |
|  beam=5   |  12.77   | 5.88 | 1.10 |
|  beam=6   |  13.33   | 5.85 | 1.09 |
|  beam=7   |  14.02   | 6.07 | 1.11 |
|  beam=8   |  14.24   | 6.43 | 1.11 |

不考虑item与用户的相关性的的情况下(theta=0):

随着beam的增加，模型需要的时间逐渐增加。

ILAD没有明显的趋势。beam=1时和greedy的结果相似（因为只考虑多样性的情况下，第一个item选哪个都可以）。从beam=2开始随着beam的增加有升有降，并且在beam=8的时候达到最高。只是按理说，ILAD越大表示多样性越大，整体而言似乎beam search似乎没有增加结果的多样性，这可能是因为ILAD和优化目标log det(L)之间存在一定的gap。而同时模型的优化目标log det(L) 则在beam较小时呈上升趋势，在beam=4时达到最大，之后有降有升没有特别的规律。

| setting（theta=0.5） | speed | ILAD | log_prob ratio |
| -------------------- | ----- | ---- | -------------- |
| greedy               | 4.14  | 7.42 | 1              |
| beam=1               | 10.23 | 7.42 | 1              |
| beam=2               | 10.51 | 5.34 | 1.02           |
| beam=3               | 11.51 | 6.25 | 1.03           |
| beam=4               | 12.25 | 5.97 | 1.02           |
| beam=5               | 12.29 | 5.13 | 1.02           |
| beam=6               | 12.96 | 6.88 | 1.02           |
| beam=7               | 13.35 | 4.95 | 1.02           |
| beam=8               | 14.30 | 6.08 | 1.02           |

当考虑相关性，且相关性与多样性的balance系数为0.5时：

随着beam增加，模型用时增加，与前面结果一致。

ILAD仍然没有特别的规律。而log_prob_ratio则几乎稳定。这可能是因为加入了相关性的限制后，选择的余地减小。
